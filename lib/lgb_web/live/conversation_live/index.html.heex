<.page_align>
  <div class="mb-4">
    <div class="relative">
      <div class="absolute inset-y-0 left-3 flex items-center pointer-events-none">
        <.icon name="hero-magnifying-glass" class="h-5 w-5 text-gray-400" />
      </div>
      <input
        type="text"
        placeholder="Search names..."
        phx-keyup="search"
        phx-debounce="300"
        value={@search_query}
        class="w-full pl-10 pr-4 py-3 bg-white rounded-lg border border-gray-200 text-gray-900 placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-100 focus:border-purple-200 transition-all"
      />
    </div>
  </div>

  <div id="conversation" phx-update="stream">
    <div :for={{dom_id, conversation} <- @streams.conversations} id={dom_id}>
      <.link patch={~p"/conversations/#{conversation.id}"}>
        <.list_tile
          title={conversation.other_profile.handle}
          subtitle={conversation.last_message && conversation.last_message.content}
          picture_url={
            Lgb.Profiles.ProfilePicture.get_picture_url(conversation.other_profile.first_picture)
          }
          read={conversation.last_message && conversation.last_message.read}
        >
          <:trailer>
            <div class="flex items-center justify-between sm:justify-end w-full sm:w-auto gap-2">
              <span class="text-sm sm:text-base text-gray-500">
                {if conversation.last_message do
                  Calendar.strftime(conversation.last_message.inserted_at, "%I:%M %p")
                else
                  "No messages yet"
                end}
              </span>
            </div>
          </:trailer>
        </.list_tile>
      </.link>
    </div>
  </div>
</.page_align>
